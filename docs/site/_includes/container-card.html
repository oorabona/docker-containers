<!-- Enhanced Container Status Card - Glassmorphism Style -->
<div class="container-card glass status-{{ include.status_color | default: 'secondary' }}"
     data-container="{{ include.name }}"
     data-github-username="{{ include.github_username }}"
     data-dockerhub-username="{{ include.dockerhub_username }}">
  <div class="card-header-row">
    <div class="card-name">{{ include.name }}</div>
    <span class="card-badge{% if include.status_color == 'warning' %} warning{% endif %}">
      {{ include.current_version | default: 'unknown' }}
    </span>
  </div>

  <div class="card-status">
    {% if include.build_status == 'success' %}
      <i class="ti ti-circle-check" style="color: var(--accent-green);"></i>
    {% elsif include.build_status == 'failed' %}
      <i class="ti ti-circle-x" style="color: var(--accent-pink);"></i>
    {% else %}
      <i class="ti ti-loader" style="color: var(--accent-yellow);"></i>
    {% endif %}
    {{ include.status_text | default: 'Unknown' }}
  </div>

  {% if include.latest_version %}
  <div class="card-meta">
    <div class="card-meta-item">
      <span class="card-meta-label">Latest</span>
      <span class="card-meta-value">{{ include.latest_version }}</span>
    </div>
    <div class="card-meta-item">
      <span class="card-meta-label">Pulls</span>
      <span class="card-meta-value">
        <i class="ti ti-download" style="font-size: 0.75rem;"></i>
        {{ include.pull_count_formatted | default: "0" }}
      </span>
    </div>
    {% if include.size_amd64 or include.size_arm64 or include.has_variants %}
    <div class="card-meta-item">
      <span class="card-meta-label">Size (amd64)</span>
      <span class="card-meta-value" data-meta="size-amd64">{{ include.size_amd64 | default: "—" }}</span>
    </div>
    <div class="card-meta-item">
      <span class="card-meta-label">Size (arm64)</span>
      <span class="card-meta-value" data-meta="size-arm64">{{ include.size_arm64 | default: "—" }}</span>
    </div>
    {% endif %}
  </div>
  {% endif %}

  {% if include.description %}
  <div class="card-description">{{ include.description | truncate: 120 }}</div>
  {% endif %}

  <!-- Variants Section (for multi-image containers) -->
  {% if include.has_variants %}
  <div class="variants-section">
    <div class="variants-header">
      <i class="ti ti-versions"></i>
      <span>Available variants</span>
    </div>
    {% if include.versions %}
      <!-- Multi-version structure: group by version -->
      {% for version in include.versions %}
      <div class="version-group">
        <div class="version-label">{{ version.tag }}</div>
        <div class="variant-tags">
          {% for variant in version.variants %}
            <span class="variant-tag{% if forloop.first and forloop.parentloop.first %} selected{% endif %}"
                  title="{{ variant.description }} — Click to select"
                  data-tag="{{ variant.tag }}"
                  data-size-amd64="{{ variant.size_amd64 | default: '' }}"
                  data-size-arm64="{{ variant.size_arm64 | default: '' }}"
                  onclick="selectVariantTag(this)"
                  style="cursor: pointer;">
              :{{ variant.name }}
              {% if variant.is_default %}<span class="badge badge-primary">default</span>{% endif %}
            </span>
          {% endfor %}
        </div>
      </div>
      {% endfor %}
    {% else %}
      <!-- Single-version structure -->
      <div class="variant-tags">
        {% for variant in include.variants %}
          <span class="variant-tag{% if forloop.first %} selected{% endif %}"
                title="{{ variant.description }} — Click to select"
                data-tag="{{ variant.tag }}"
                data-size-amd64="{{ variant.size_amd64 | default: '' }}"
                data-size-arm64="{{ variant.size_arm64 | default: '' }}"
                onclick="selectVariantTag(this)"
                style="cursor: pointer;">
            :{{ variant.tag }}
            {% if variant.is_default %}<span class="badge badge-primary">default</span>{% endif %}
          </span>
        {% endfor %}
      </div>
    {% endif %}
  </div>
  {% endif %}

  <!-- Docker Pull Command Section -->
  {% if include.ghcr_image and include.dockerhub_image %}
  <div class="pull-section"
       data-ghcr-base="ghcr.io/{{ include.github_username }}/{{ include.name }}"
       data-dockerhub-base="docker.io/{{ include.dockerhub_username }}/{{ include.name }}"
       data-default-tag="{% if include.has_variants %}{% if include.versions %}{{ include.versions[0].variants[0].tag }}{% else %}{{ include.variants[0].tag }}{% endif %}{% else %}{{ include.current_version }}{% endif %}">
    <div class="pull-header">
      <i class="ti ti-brand-docker"></i>
      <span>Pull command</span>
    </div>
    <div class="pull-input-group">
      <input type="text"
             class="pull-input"
             id="pull-{{ include.name }}"
             value="docker pull {{ include.ghcr_image }}"
             readonly>
      <button class="copy-btn" type="button"
              onclick="copyToClipboard('pull-{{ include.name }}', this)"
              title="Copy to clipboard">
        <i class="ti ti-copy"></i>
      </button>
    </div>
  </div>
  {% endif %}

  <!-- Quick Links -->
  <div class="card-links">
    <a href="{{ '/container?name=' | append: include.name | relative_url }}"
       class="card-link" title="View Details">
      <i class="ti ti-info-circle"></i> Details
    </a>
    <a href="https://github.com/{{ include.github_username }}/docker-containers/tree/master/{{ include.name }}"
       class="card-link" target="_blank" title="View Source">
      <i class="ti ti-folder"></i> Source
    </a>
    <a href="https://ghcr.io/{{ include.github_username }}/{{ include.name }}"
       class="card-link" target="_blank" title="GHCR Package">
      <i class="ti ti-package"></i> GHCR
    </a>
    <a href="https://hub.docker.com/r/{{ include.dockerhub_username }}/{{ include.name }}"
       class="card-link" target="_blank" title="Docker Hub">
      <i class="ti ti-brand-docker"></i> Hub
    </a>
  </div>
</div>
