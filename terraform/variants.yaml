# Terraform Container Variants
# Defines multiple image variants to reduce attack surface and image sizes
#
# Each variant produces a separate image tag:
#   ghcr.io/oorabona/terraform:latest          (full - default for backwards compatibility)
#   ghcr.io/oorabona/terraform:1.10.5-base     (base variant)
#   ghcr.io/oorabona/terraform:1.10.5-aws      (AWS variant)
#   etc.

# Build configuration
build:
  # Build arg to pass for flavor selection
  flavor_arg: FLAVOR
  # No extension dependencies (unlike postgres)
  requires_extensions: false

# Single version entry with multiple variants
# NOTE: Terraform uses dynamic versioning - actual version comes from version.sh
# The "latest" tag is a fallback key for variant lookups when version is dynamic
versions:
  - tag: "latest"
    variants:
      - name: base
        suffix: "-base"
        flavor: base
        description: "Terraform + TFLint + Trivy + Terragrunt + terraform-docs + gh CLI"
        build_args_include:
          - TFLINT_VERSION
          - TRIVY_VERSION
          - TERRAGRUNT_VERSION
          - TERRAFORM_DOCS_VERSION
          - GITHUB_CLI_VERSION
      - name: aws
        suffix: "-aws"
        flavor: aws
        description: "Base + AWS CLI"
        build_args_include:
          - TFLINT_VERSION
          - TRIVY_VERSION
          - TERRAGRUNT_VERSION
          - TERRAFORM_DOCS_VERSION
          - GITHUB_CLI_VERSION
          - AWS_CLI_VERSION
      - name: azure
        suffix: "-azure"
        flavor: azure
        description: "Base + Azure CLI"
        build_args_include:
          - TFLINT_VERSION
          - TRIVY_VERSION
          - TERRAGRUNT_VERSION
          - TERRAFORM_DOCS_VERSION
          - GITHUB_CLI_VERSION
          - AZURE_CLI_VERSION
      - name: gcp
        suffix: "-gcp"
        flavor: gcp
        description: "Base + Google Cloud SDK"
        build_args_include:
          - TFLINT_VERSION
          - TRIVY_VERSION
          - TERRAGRUNT_VERSION
          - TERRAFORM_DOCS_VERSION
          - GITHUB_CLI_VERSION
          - GCP_CLI_VERSION
      - name: full
        suffix: ""
        flavor: full
        description: "All cloud CLIs included (AWS + Azure + GCP)"
        default: true
        build_args_include:
          - TFLINT_VERSION
          - TRIVY_VERSION
          - TERRAGRUNT_VERSION
          - TERRAFORM_DOCS_VERSION
          - GITHUB_CLI_VERSION
          - AWS_CLI_VERSION
          - AZURE_CLI_VERSION
          - GCP_CLI_VERSION
